# View(data[others, ])
# There exist more:
# √É≈∏ = ß
# √É∆í√Ü‚Äô√É‚Ä¶√Ç¬∏ = ß
# Ö:
# √É¬∂ = ö
# √É∆í√Ü‚Äô√É‚Ä†√¢‚Ç¨‚Ñ¢√É∆í√¢‚Ç¨ √É¬¢√¢‚Äö¬¨√¢‚Äû¬¢√É∆í√Ü‚Äô√É¬¢√¢‚Äö¬¨√Ö¬°√É∆í√¢‚Ç¨≈°√É‚Äö√Ç¬∂ = ö
# √É∆í√Ü‚Äô√É‚Äö√Ç¬∂ = ö
# Ü:
# √É¬º = ü
# √É∆í√Ü‚Äô√É‚Ä†√¢‚Ç¨‚Ñ¢√É∆í√¢‚Ç¨ √É¬¢√¢‚Äö¬¨√¢‚Äû¬¢√É∆í√Ü‚Äô√É¬¢√¢‚Äö¬¨√Ö¬°√É∆í√¢‚Ç¨≈°√É‚Äö√Ç¬º = ü
# √É∆í√Ü‚Äô√É‚Ä†√¢‚Ç¨‚Ñ¢√É∆í√¢‚Ç¨≈°√É‚Äö√Ç¬º = ü
# √É∆í√Ü‚Äô√É‚Äö√Ç¬º = ü
# √É¬É¬º = ü
# Ä:
# √É¬§A4 = ä
# √É∆í√Ü‚Äô√É‚Äö√Ç¬§ = ä
# √É¬§ = ä
# √É∆í√Ç¬§ = ä
others <- setdiff(others, grep('√É≈∏', data$page))
others <- setdiff(others, grep('√É∆í√Ü‚Äô√É‚Ä†√¢‚Ç¨‚Ñ¢√É∆í√¢‚Ç¨ √É¬¢√¢‚Äö¬¨√¢‚Äû¬¢√É∆í√Ü‚Äô√É¬¢√¢‚Äö¬¨√Ö¬°√É∆í√¢‚Ç¨≈°√É‚Äö√Ç¬', data$page))
others <- setdiff(others, grep('√É¬∂', data$page))
others <- setdiff(others, grep('√É∆í√Ü‚Äô√É‚Äö√Ç¬∂', data$page))
others <- setdiff(others, grep('√É¬º', data$page))
others <- setdiff(others, grep('√É∆í√Ü‚Äô√É‚Äö√Ç¬º', data$page))
others <- setdiff(others, grep('√É¬§A4', data$page))
others <- setdiff(others, grep('√É∆í√Ü‚Äô√É‚Äö√Ç¬§', data$page))
others <- setdiff(others, grep('√É¬§', data$page))
others <- setdiff(others, grep('√É∆í√Ç¬§', data$page))
others <- setdiff(others, grep('√É∆í√Ü‚Äô√É‚Ä†√¢‚Ç¨‚Ñ¢√É∆í√¢‚Ç¨≈°√É‚Äö√Ç¬º', data$page))
others <- setdiff(others, grep('√É¬É¬º', data$page))
# View(data[others,])
# Thesis is a pattern for the most escaped letters:
# - √(something)º = ü Problem:
#                     √É∆í√Ü‚Äô√É‚Ä†√¢‚Ç¨‚Ñ¢√É∆í√¢‚Ç¨≈°√É‚Äö√Ç¬º because 2 times °
#                     √É∆í√Ü‚Äô√É‚Ä†√¢‚Ç¨‚Ñ¢√É∆í√¢‚Ç¨ √É¬¢√¢‚Äö¬¨√¢‚Äû¬¢√É∆í√Ü‚Äô√É¬¢√¢‚Äö¬¨√Ö¬°√É∆í√¢‚Ç¨≈°√É‚Äö√Ç¬º
#                     Solution: ° is different to º and º only one time at the end!
# - %C3%BC = ü
# - √(something)∂ = ö Problem: none
# - %C3%B6 = ö
# - √(something)§ = ä Problem: √É¬§A4 and because one more letter
# - %C3%A4 = ä
# - A4 = ä
# - "¬® " = ä
# - √(something)ü or √(something)∏ = ß Problem: should be parsed before ü because it uses ü
# - %C3%9F = ß
#
# Replace letters:
temp <- data[others, "page"]
data[ß, "page"]
data_sub <- data
data_sub$page <- gsub("(√[^A-Za-z]*?[ü∏])|%C3%9F", "ß", data_sub$page) # ß
data_sub$page <- gsub("(√[^A-Za-z]*?º)|%C3%BC", "ü", data_sub$page) # ü
data_sub$page <- gsub("(√[^A-Za-z]*?∂)|%C3%B6", "ö", data_sub$page) # ö
data_sub$page <- gsub("(√[^A-Za-z]*?§(A4)?)|(A4)|¬® ", "ä", data_sub$page) # ä
# View(data_sub)
# Unsolved Problem: ¬ is sometimes in the data but don't know what it does
####### REMOVE ESCAPED LETTERS END #######
####### FIND DUPLICATES START #######
# Find the duplicates
data_dup <- data_sub[(duplicated(data_sub$page) | duplicated(data_sub$page, fromLast = T)),]
# Sum the amount of visits and replace the 0's with NA
data_agg <- aggregate(x = data_sub[ , colnames(data_sub) != "page"],             # Mean by group
by = list(data_sub$page),
FUN = sum,
na.rm = TRUE
)
data_agg[data_agg == 0] <- NA
####### FIND DUPLICATES END #######
View(data_dup)
View(data_agg)
####### TASK A) 10 most used pages START#######
# Add the sum of visits | sum of impressions
month_cols <- names(page_impressions)[grep("[0-9]*[.][0-9]", names(page_impressions))]
# Both tables have the same month col names!
month_cols == names(page_visits)[grep("[0-9]*[.][0-9]", names(page_visits))]
####### TASK A) 10 most used pages START#######
# Add the sum of visits | sum of impressions
month_cols <- names(page_impressions)[grep("[0-9]*[.][0-9]", names(page_impressions))]
####### DIVIDE IN TWO TABLES START #######
# For the shiny app the Month must be detected by itself. Goal: two data frames
# One for the page impressions and one for the page visits
cols <- colnames(data_agg)
cols_pi <- cols[grep('pi', cols)]
cols_v <- cols[grep('v', cols)]
page_impressions <- data_agg[ , c('page', cols_pi)]
page_visits <- data_agg[ , c('page', cols_v)]
View(page_impressions)
page_impressions <- data_agg[ , c('page', cols_pi)]
####### DIVIDE IN TWO TABLES START #######
# For the shiny app the Month must be detected by itself. Goal: two data frames
# One for the page impressions and one for the page visits
cols <- colnames(data_agg)
cols_pi <- cols[grep('pi', cols)]
cols_v <- cols[grep('v', cols)]
page_impressions <- data_agg[ , c('page', cols_pi)]
page_visits <- data_agg[ , c('page', cols_v)]
cols_pi <- cols[grep('pi', cols)]
cols_v <- cols[grep('v', cols)]
c('page', cols_pi)
View(data_agg)
View(data_agg)
# Sum the amount of visits and replace the 0's with NA
data_agg <- aggregate(x = data_sub[ , colnames(data_sub) != "page"],             # Mean by group
by = list(data_sub$page),
FUN = sum,
na.rm = TRUE
)
colnames(data_agg)[colnames(data_agg) == 'Group.1'] <- 'page'
data_agg[data_agg == 0] <- NA
####### DIVIDE IN TWO TABLES START #######
# For the shiny app the Month must be detected by itself. Goal: two data frames
# One for the page impressions and one for the page visits
cols <- colnames(data_agg)
cols_pi <- cols[grep('pi', cols)]
cols_v <- cols[grep('v', cols)]
page_impressions <- data_agg[ , c('page', cols_pi)]
page_visits <- data_agg[ , c('page', cols_v)]
View(page_impressions)
View(page_visits)
# Rename the columns
names(page_impressions) <- gsub("X|([.]pi)", "", names(page_impressions))
# Rename the columns
names(page_impressions) <- gsub("X|([.]pi)", "", names(page_impressions))
names(page_visits) <- gsub("X|[.]v", "", names(page_visits))
####### TASK A) 10 most used pages START#######
# Add the sum of visits | sum of impressions
month_cols <- names(page_impressions)[grep("[0-9]*[.][0-9]", names(page_impressions))]
# Both tables have the same month col names!
month_cols == names(page_visits)[grep("[0-9]*[.][0-9]", names(page_visits))]
# Calculate the sums
sum_pi <- apply(page_impressions[,month_cols], c(1), function(x) {sum(x, na.rm = T)})
sum_v <- apply(page_visits[,month_cols], c(1), function(x) {sum(x, na.rm = T)})
page_impressions['sum'] <- sum_pi
page_visits['sum'] <- sum_v
# Order decreasing by sum
page_impressions <- page_impressions[order(page_impressions$sum, decreasing = T), ]
head(page_impressions$sum)
page_visits <- page_visits[order(page_visits$sum, decreasing = T), ]
head(page_visits$sum)
top10_imperssions <- page_impressions[which(page_impressions$page %in% head(page_impressions, 10)$page),]
View(top10_imperssions)
top10_visits <- page_visits[which(page_visits$page %in% head(page_visits, 10)$page)]
View(top10_visits)
View(top10_imperssions)
View(top10_visits)
View(top10_imperssions)
top10_visits <- page_visits[which(page_visits$page %in% head(page_visits, 10)$page),]
View(top10_visits)
+ geom_bar(mapping = aes(top10_imperssions$page))
ggplot(data=top10_imperssions) +
geom_bar(mapping = aes(top10_imperssions$page))
ggplot(data=top10_imperssions) +
geom_bar(mapping = aes(top10_imperssions$page, top10_imperssions$sum))
ggplot(data=top10_imperssions) +
geom_bar(mapping = aes(x = top10_imperssions$page, y = top10_imperssions$sum))
ggplot(data=top10_imperssions) +
geom_point(mapping = aes(x = top10_imperssions$page, y = top10_imperssions$sum))
ggplot(data=top10_imperssions) +
geom_bar(mapping = aes(top10_imperssions$sum))
ggplot(data=top10_imperssions) +
geom_bar(mapping = aes(top10_imperssions$sum))
ggplot(data=top10_imperssions) +
geom_bar(mapping = aes(top10_imperssions$page))
####### TASK A) 10 most used pages ALTRNATIVE START#######
# Add the sum of visits | sum of impressions
month_cols <- names(data_agg)[grep("X[0-9]*[.][0-9].", names(data_agg))]
####### TASK A) 10 most used pages ALTRNATIVE START#######
# Add the sum of visits | sum of impressions
month_cols <- names(data_agg)[grep("X[0-9]*[.][0-9].*", names(data_agg))]
####### TASK A) 10 most used pages ALTRNATIVE START#######
# Add the sum of visits | sum of impressions
month_cols_pi <- names(data_agg)[grep("X[0-9]*[.][0-9].pi", names(data_agg))]
month_cols_v <- names(data_agg)[grep("X[0-9]*[.][0-9].v", names(data_agg))]
####### TASK A) 10 most used pages ALTRNATIVE START#######
# Add the sum of visits | sum of impressions
month_cols_pi <- names(data_agg)[grep("X[0-9]*[.][0-9][.]pi", names(data_agg))]
month_cols_v <- names(data_agg)[grep("X[0-9]*[.][0-9][.]v", names(data_agg))]
month_cols_v <- names(data_agg)[grep("X[0-9]*[.][0-9][0-9][.]v", names(data_agg))]
####### TASK A) 10 most used pages ALTRNATIVE START#######
# Add the sum of visits | sum of impressions
month_cols_pi <- names(data_agg)[grep("X[0-9]*[.][0-9][0-9][.]pi", names(data_agg))]
month_cols_v <- names(data_agg)[grep("X[0-9]*[.][0-9][0-9][.]v", names(data_agg))]
####### TASK A) 10 most used pages ALTRNATIVE START#######
data_enr <- data_agg
# Add the sum of visits | sum of impressions
month_cols_pi <- names(data_enr)[grep("X[0-9]*[.][0-9][0-9][.]pi", names(data_enr))]
month_cols_v <- names(data_enr)[grep("X[0-9]*[.][0-9][0-9][.]v", names(data_enr))]
# Calculate the sums
sum_pi <- apply(data_enr[,month_cols_pi], c(1), function(x) {sum(x, na.rm = T)})
sum_v <- apply(data_enr[,month_cols_v], c(1), function(x) {sum(x, na.rm = T)})
data_enr['sum_pi'] <- sum_pi
data_enr['sum_v'] <- sum_v
View(data_enr)
head(data_enr$sum_v)
# Order decreasing by sum of visits
data_enr <- data_enr[order(data_enr$sum_v, decreasing = T), ]
head(data_enr$sum_v)
View(data_enr)
# Get the 10 highest per class
# top10_imperssions <- page_impressions[which(page_impressions$page %in% head(page_impressions, 10)$page),]
top10_visits <- data_enr[which(data_enr$page %in% head(data_enr, 10)$page),]
ggplot(data=top10_imperssions) +
geom_bar(mapping = aes(top10_imperssions$page))
View(top10_visits)
ggplot(data=top10_visits) +
geom_line(mapping = aes(x = top10_visits$sum_i, y = top10_visits$sum_v))
ggplot(data=top10_visits) +
geom_line(mapping = aes(x = sum_i, y = sum_v))
ggplot(data=top10_visits) +
geom_line(mapping = aes(x = sum_pi, y = sum_v))
ggplot(data=data_enr) +
geom_line(mapping = aes(x = sum_pi, y = sum_v))
ggplot(data=data_enr) +
geom_point(mapping = aes(x = sum_pi, y = sum_v))
View(data_enr)
ggplot(data=top10_visits) +
geom_point(mapping = aes(x = sum_pi, y = sum_v))
ggplot(data=top10_visits) +
geom_bar(mapping = aes(x = sum_pi, y = sum_v))
ggplot(data=top10_visits) +
geom_bar(mapping = aes(x = sum_pi))
ggplot(data=top10_visits) +
geom_bar(mapping = aes(x = page))
ggplot(data=top10_visits) +
geom_histogram(mapping = aes(x = page))
ggplot(data=top10_visits) +
geom_histogram(mapping = aes(x = sum_pi))
ggplot(data=data_enr) +
geom_point(mapping = aes(x = sum_pi, y = sum_v))
ggplot(data=top10_visits) +
geom_point(mapping = aes(x = sum_pi, y = sum_v))
View(data_err[,c('page','sum_v', 'sum_i')])
View(data_enr[,c('page','sum_v', 'sum_i')])
View(data_enr[,c('page','sum_v', 'sum_pi')])
ggplot(data=top10_visits) +
geom_col(mapping = aes(x = page, y = sum_v))
ggplot(data=top10_visits) +
geom_col(mapping = aes(x = page, y = sum_v))+
geom_col(mapping = aes(x = page, y = sumpi))
ggplot(data=top10_visits) +
geom_col(mapping = aes(x = page, y = sum_v)) +
geom_col(mapping = aes(x = page, y = sum_pi))
ggplot(data=top10_visits) +
geom_col(mapping = aes(x = page, y = sum_v), color = "blue") +
geom_col(mapping = aes(x = page, y = sum_pi), color = "red")
ggplot(data=top10_visits) +
geom_col(mapping = aes(x = page, y = sum_v), color = "blue") +
geom_col(mapping = aes(x = page, y = sum_pi), color = "red",position = "dodge"))
ggplot(data=top10_visits) +
#geom_col(mapping = aes(x = page, y = sum_v), color = "blue") +
geom_col(mapping = aes(x = page, y = sum_pi), color = "red",position = "dodge"))
ggplot(data=top10_visits) +
#geom_col(mapping = aes(x = page, y = sum_v), color = "blue") +
geom_col(mapping = aes(x = page, y = sum_pi), color = "red",position = "dodge")
ggplot(data=top10_visits) +
#geom_col(mapping = aes(x = page, y = sum_v), color = "blue") +
geom_col(mapping = aes(x = page, y = sum_pi), color = "red")
ggplot(data=top10_visits) +
#geom_col(mapping = aes(x = page, y = sum_v), color = "blue") +
geom_col(mapping = aes(x = page, y = sum_pi), fill = "red")
ggplot(data=top10_visits) +
geom_col(mapping = aes(x = page, y = sum_v), fill = "blue")
p1 <- ggplot(top10_visits,
aes(x=top10_visits,y=value,group=page,fill=page)) +
geom_bar(stat="identity",position="dodge")
p1
p1 <- ggplot(top10_visits,
aes(x=top10_visits,y=sum_pi,group=page,fill=page)) +
geom_bar(stat="identity",position="dodge")
p1
p1 <- ggplot(top10_visits,
aes(x=top10_visits,y=sum_pi, fill=page)) +
geom_bar(stat="identity",position="dodge")
p1
ggplot(top10_visits,
aes(x=top10_visits,y=sum_pi, fill=page)) +
geom_bar(stat="identity",position="dodge")
ggplot(melt(top10_visits), aes(page, value, colour = variable)) +
geom_point()
?interaction
interaction
ggplot(top10_visits, aes(x,y,fill=page)) + geom_bar(stat="identity", position = "dodge")
ggplot(top10_visits, aes(page, sum_pi,fill=page)) + geom_bar(stat="identity", position = "dodge")
ggplot(top10_visits, aes(page, sum_pi,fill=sum_v)) + geom_bar(stat="identity", position = "dodge")
ggplot(top10_visits, aes(sum_v, sum_pi,fill=page)) + geom_bar(stat="identity", position = "dodge")
ggplot(test_data, aes(page)) +
geom_line(aes(y = sum_v, colour = "var0")) +
geom_line(aes(y = sum_pi, colour = "var1"))
ggplot(top10_visits, aes(page)) +
geom_line(aes(y = sum_v, colour = "var0")) +
geom_line(aes(y = sum_pi, colour = "var1"))
library(tidyr)
library(reshape2)
install.packages("reshape2")
library(reshape2)
?melt
melted <- melt(top10_visits, id="page")
View(melted)
ggplot(data=melted,
aes(x=page, y=value, colour=variable)) +
geom_line()
melted <- melt(top10_visits[,c("page", "sum_v", "sum_pi")], id="page")
ggplot(data=melted,
aes(x=page, y=value, colour=variable)) +
geom_line()
View(melted)
ggplot(data=melted,
aes(x=variable, y=value, colour=variable)) +
geom_line()
ggplot(data=melted,
aes(x=variable, y=value, colour=variable)) +
geom_bar(mapping=aes(group=variable))
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
p1 <- ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
geom_point(aes(fill = variable))
p1 <- ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
geom_point(aes(fill = variable), position = "dodge", stat="identity")
order(melted$value, decreasing = T)
order(melted$value, decreasing = F)
melted <- melted[order(melted$value, decreasing = F), ]
p1 <- ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
melted <- melted[order(melted$variable, decreasing = F), ]
p1 <- ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
melted <- melt(top10_visits[,c("page", "sum_v", "sum_pi")], id="page")
melted <- melted[order(melted$value, decreasing = F), ]
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity")
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
geom_point(aes(fill = variable))
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
geom_tile("Sum of Page Impressions and Visits of the 10 most visited pages")
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of Page Impressions and Visits of the 10 most visited pages")
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page iImpressions and visits of the 10 most visited pages")
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page iImpressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page")
ggplot(melted, aes(reorder(page, -value, sum))) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page iImpressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page")
ggplot(melted, aes(reorder(page, -value))) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page iImpressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page")
ggplot(melted, aes(reorder(page, -value), reorder(page, -value))) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page iImpressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page")
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page iImpressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page")
ggplot(melted, aes(page, value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page iImpressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page")
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page iImpressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page")
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('sum visits', 'sum page impressions'))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions (PI) and visits (V) of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('sum V', 'sum PI'))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions (PI) and visits (V) of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('sum V', 'Page impressions'))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions (PI) and visits (V) of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions'))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions'))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top")
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=90,hjust=20,vjust=0.5))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=90,hjust=-20,vjust=0.5))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=90,hjust=-1,vjust=0.5))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=0.5))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1, size=4))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1, size=5))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1, size=20))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1, size=12))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=20,hjust=1,vjust=1))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=50,hjust=1,vjust=1))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
labs(fill='Legend Title') +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1))
ggplot(melted, aes(reorder(page, -value), value)) +
geom_bar(aes(fill = variable), position = "dodge", stat="identity") +
ggtitle("Sum of page impressions and visits of the 10 most visited pages") +
ylab("Sum") + xlab("Page") +
scale_fill_discrete(labels=c('Visits', 'Page impressions')) +
labs(fill='') +
theme(legend.position = "top", axis.text.x=element_text(angle=45,hjust=1,vjust=1))
View(melted)
?reorder
